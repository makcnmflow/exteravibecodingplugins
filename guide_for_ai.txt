# –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –ø–ª–∞–≥–∏–Ω–æ–≤ –¥–ª—è exteraGram

–Ø —Ç—â–∞—Ç–µ–ª—å–Ω–æ –∏–∑—É—á–∏–ª –≤—Å—é –¥–æ—Å—Ç—É–ø–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –ø–ª–∞–≥–∏–Ω–æ–≤ –¥–ª—è exteraGram. –í–æ—Ç –ø–æ–ª–Ω—ã–π –∏ –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ–±–∑–æ—Ä –≤—Å–µ–≥–æ, —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–Ω–∞—Ç—å –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞–≥–∏–Ω–æ–≤.

## –í–≤–µ–¥–µ–Ω–∏–µ –≤ —Å–∏—Å—Ç–µ–º—É –ø–ª–∞–≥–∏–Ω–æ–≤ exteraGram

–°–∏—Å—Ç–µ–º–∞ –ø–ª–∞–≥–∏–Ω–æ–≤ exteraGram —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ **Chaquopy v16** (–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è Java –∏ Python) –∏ **Aliucord hook** (—Å–∏—Å—Ç–µ–º–∞ —Ö—É–∫–æ–≤ –∏–∑ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ Discord)[1][2]. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º –ø–∏—Å–∞—Ç—å –ø–ª–∞–≥–∏–Ω—ã –Ω–∞ **Python 3.11** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Xposed-–ø–æ–¥–æ–±–Ω–æ–≥–æ** –º–µ—Ç–æ–¥–∞ —Ö—É–∫–æ–≤ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è[1][2].

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

**1. –°–∫–∞—á–∞–π—Ç–µ exteraGram**
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é exteraGram –∏–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤. –ú–æ–∂–Ω–æ —Å–∫–∞—á–∞—Ç—å –∏–∑ –±–µ—Ç–∞-–∫–∞–Ω–∞–ª–∞[1].

**2. –í–∫–ª—é—á–∏—Ç–µ –¥–≤–∏–∂–æ–∫ –ø–ª–∞–≥–∏–Ω–æ–≤**
–ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –≤ –∞–∫–∫–∞—É–Ω—Ç –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ `exteraGram Preferences` > `Plugins` –∏ –≤–∫–ª—é—á–∏—Ç–µ –¥–≤–∏–∂–æ–∫ –ø–ª–∞–≥–∏–Ω–æ–≤. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É info –∏ –≤–∫–ª—é—á–∏—Ç–µ —Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞[1].

**3. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç**
- –°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É –Ω–∞ –ü–ö
- –°–æ–∑–¥–∞–π—Ç–µ Python —Ñ–∞–π–ª, –Ω–∞–ø—Ä–∏–º–µ—Ä `first_plugin.py`
- –°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `exteragram-utils` –¥–ª—è —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ –∏ –∫–ª–∏–µ–Ω—Ç–∞ hot-reload[1]

```bash
pip install exteragram-utils
```

**4. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Ç–µ–ª–µ—Ñ–æ–Ω—É**
- –ü–æ–¥–∫–ª—é—á–∏—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω –∫ –ü–ö —á–µ—Ä–µ–∑ USB
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ ADB –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –≤–∞—à–µ–º `PATH`[1]

**5. VS Code Remote Debugging**
–î–ª—è VS Code –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ remote debugging. –í–∞–∂–Ω–æ: `remoteRoot` –¥–æ–ª–∂–µ–Ω –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å—Å—è –Ω–∞ `PLUGIN_ID.py`[1].

## –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–ª–∞–≥–∏–Ω–∞

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã

–í—Å–µ —Ñ–∞–π–ª—ã `.plugin` –¥–æ–ª–∂–Ω—ã –≤–∫–ª—é—á–∞—Ç—å[3]:

1. **–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ** ‚Äî –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –∫–∞–∫ **–ø—Ä–æ—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏** (–±–µ–∑ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏)
2. **–û–¥–∏–Ω –∫–ª–∞—Å—Å**, –Ω–∞—Å–ª–µ–¥—É—é—â–∏–π –æ—Ç `BasePlugin`

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —à–∞–±–ª–æ–Ω –ø–ª–∞–≥–∏–Ω–∞

```python
__id__ = "my_plugin"
__name__ = "My Plugin"
__description__ = "Description of my plugin"
__author__ = "@yourUsername"
__version__ = "1.0.0"
__icon__ = "PackName/0"
__min_version__ = "11.12.0"

from base_plugin import BasePlugin

class MyPlugin(BasePlugin):
    def on_plugin_load(self):
        self.log("Plugin loaded!")
```

## –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø–ª–∞–≥–∏–Ω–∞

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è[4]

- `__id__`: –î–æ–ª–∂–µ–Ω –±—ã—Ç—å 2-32 —Å–∏–º–≤–æ–ª–∞, –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å –±—É–∫–≤—ã, —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –ª–∞—Ç–∏–Ω—Å–∫–∏–µ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã, –¥–µ—Ñ–∏—Å—ã (`-`) –∏ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è (`_`)
- `__name__`: –ò–º—è –ø–ª–∞–≥–∏–Ω–∞

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–æ–ª—è[4]

- `__author__`: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç –∏–ª–∏ Telegram username/—Å—Å—ã–ª–∫–∏ –Ω–∞ –∫–∞–Ω–∞–ª—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `@yourUsername` –∏–ª–∏ `@yourPluginChannel`). –ú–æ–≥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∫–∞–∫ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏
- `__description__`: –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –±–∞–∑–æ–≤—ã–π markdown –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- `__version__`: –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `1.0`, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–æ
- `__icon__`: –§–æ—Ä–º–∞—Ç ‚Äî –∫–æ—Ä–æ—Ç–∫–æ–µ –∏–º—è —Å—Ç–∏–∫–µ—Ä–ø–∞–∫–∞ + –∏–Ω–¥–µ–∫—Å —Å—Ç–∏–∫–µ—Ä–∞ —á–µ—Ä–µ–∑ `/`. –ò–Ω–¥–µ–∫—Å –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `0`. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è —Å—Ç–∏–∫–µ—Ä–ø–∞–∫–∞ `https://t.me/addstickers/MyPackName` –∫–æ—Ä–æ—Ç–∫–æ–µ –∏–º—è ‚Äî `MyPackName`, –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ —Å—Ç–∏–∫–µ—Ä–∞: `MyPackName/1`
- `__min_version__`: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è exteraGram, –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –¥–≤–∏–∂–∫–æ–º

**–í–∞–∂–Ω–æ:** –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø–∞—Ä—Å—è—Ç—Å—è —á–µ—Ä–µ–∑ `AST`, –ø–æ—ç—Ç–æ–º—É –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—é —Å—Ç—Ä–æ–∫ –∏–ª–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ[4].

## –°–æ–±—ã—Ç–∏—è –ø–ª–∞–≥–∏–Ω–∞

### –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –≤—ã–≥—Ä—É–∑–∫–∞[4]

```python
def on_plugin_load(self):
    # –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ –ø–ª–∞–≥–∏–Ω–∞ –∏–ª–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    pass

def on_plugin_unload(self):
    # –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏ –ø–ª–∞–≥–∏–Ω–∞ –∏–ª–∏ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    pass
```

### –°–æ–±—ã—Ç–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è[4]

Enum `AppEvent` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏—è:
- `START` ‚Äî –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- `STOP` ‚Äî –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è  
- `PAUSE` ‚Äî –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Ñ–æ–Ω
- `RESUME` ‚Äî –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –Ω–∞ –ø–µ—Ä–µ–¥–Ω–∏–π –ø–ª–∞–Ω

## –ú–µ–Ω—é Items (–ø—É–Ω–∫—Ç—ã –º–µ–Ω—é)

### MenuItemData[4]

–î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –≤ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–µ–Ω—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é `self.add_menu_item()`:

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `menu_type: MenuItemType` ‚Äî —Ç–∏–ø –º–µ–Ω—é:
  - `MESSAGE_CONTEXT_MENU` ‚Äî –º–µ–Ω—é –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ
  - `DRAWER_MENU` ‚Äî –≥–ª–∞–≤–Ω–æ–µ –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–æ–µ –º–µ–Ω—é (–±–æ–∫–æ–≤–æ–µ –º–µ–Ω—é)
  - `CHAT_ACTION_MENU` ‚Äî –º–µ–Ω—é —Å —Ç—Ä–µ–º—è —Ç–æ—á–∫–∞–º–∏ –≤–Ω—É—Ç—Ä–∏ —á–∞—Ç–∞
  - `PROFILE_ACTION_MENU` ‚Äî –º–µ–Ω—é —Å —Ç—Ä–µ–º—è —Ç–æ—á–∫–∞–º–∏ –≤ –ø—Ä–æ—Ñ–∏–ª–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è/–±–æ—Ç–∞/–∫–∞–Ω–∞–ª–∞
- `text: str` ‚Äî —Ç–µ–∫—Å—Ç, –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã–π –¥–ª—è –ø—É–Ω–∫—Ç–∞ –º–µ–Ω—é
- `on_click: Callable[[Dict[str, Any]], None]` ‚Äî —Ñ—É–Ω–∫—Ü–∏—è, –≤—ã–∑—ã–≤–∞–µ–º–∞—è –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏

**–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `item_id: str` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ `remove_menu_item()`
- `icon: str` ‚Äî –∏–º—è drawable —Ä–µ—Å—É—Ä—Å–∞ –¥–ª—è –∏–∫–æ–Ω–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `"msg_info"`, `"msg_delete"`)
- `subtext: str` ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç –ø–æ–¥ –æ—Å–Ω–æ–≤–Ω—ã–º
- `condition: str` ‚Äî MVEL –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è —É—Å–ª–æ–≤–Ω–æ–≥–æ –ø–æ–∫–∞–∑–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `"message.isOut()"`)
- `priority: int` ‚Äî —á–∏—Å–ª–æ –¥–ª—è –≤–ª–∏—è–Ω–∏—è –Ω–∞ –ø–æ–∑–∏—Ü–∏—é –≤ –º–µ–Ω—é (–±–æ–ª—å—à–∏–µ —á–∏—Å–ª–∞ –ø–µ—Ä–≤—ã–º–∏)

### –ö–æ–Ω—Ç–µ–∫—Å—Ç on_click[4]

Callback `on_click` –ø–æ–ª—É—á–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å —Å –¥–∞–Ω–Ω—ã–º–∏, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–º–∏ –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞. –í–æ–∑–º–æ–∂–Ω—ã–µ –∫–ª—é—á–∏:

- `account: int` ‚Äî –Ω–æ–º–µ—Ä —Ç–µ–∫—É—â–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
- `context: android.content.Context` ‚Äî Android –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `fragment: org.telegram.ui.ActionBar.BaseFragment` ‚Äî —Ç–µ–∫—É—â–∏–π UI —Ñ—Ä–∞–≥–º–µ–Ω—Ç
- `dialog_id: long` ‚Äî ID –¥–∏–∞–ª–æ–≥–∞ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —á–∞—Ç–∞
- `user: TLRPC.User` ‚Äî –æ–±—ä–µ–∫—Ç User (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –ø—Ä–æ—Ñ–∏–ª–µ)
- `userId: long` ‚Äî ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `userFull: TLRPC.UserFull` ‚Äî –ø–æ–ª–Ω—ã–π –æ–±—ä–µ–∫—Ç —Å –¥–µ—Ç–∞–ª—è–º–∏
- `chat: TLRPC.Chat` ‚Äî –æ–±—ä–µ–∫—Ç Chat –¥–ª—è –≥—Ä—É–ø–ø—ã –∏–ª–∏ –∫–∞–Ω–∞–ª–∞
- `chatId: long` ‚Äî ID —á–∞—Ç–∞
- `chatFull: TLRPC.ChatFull` ‚Äî –ø–æ–ª–Ω—ã–π –æ–±—ä–µ–∫—Ç —á–∞—Ç–∞
- `encryptedChat: TLRPC.EncryptedChat` ‚Äî –æ–±—ä–µ–∫—Ç –¥–ª—è —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ —á–∞—Ç–∞
- `message: org.telegram.messenger.MessageObject` ‚Äî –æ–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
- `groupedMessages` ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–µ–¥–∏–∞
- `botInfo: TL_bots.BotInfo` ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–µ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–∞ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º[4]:
```python
self.log(f"Context keys: {list(context.keys())}")
```

## –•—É–∫–∏ (Hooks)

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ö—É–∫–æ–≤[4]

–î–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –æ—Ç–≤–µ—Ç–æ–≤ –∏–ª–∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π –Ω—É–∂–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Ö—É–∫:

```python
self.add_hook("TL_messages_readHistory", match_substring=False, priority=0)
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `name` ‚Äî –∏–º—è —Å–æ–±—ã—Ç–∏—è –∏–ª–∏ –∑–∞–ø—Ä–æ—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `"TL_messages_readHistory"`)
- `match_substring` ‚Äî –µ—Å–ª–∏ `True`, —Ö—É–∫ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ —á–∞—Å—Ç–∏—á–Ω–æ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –∏–º–µ–Ω–∏
- `priority` ‚Äî —Ö—É–∫–∏ —Å –±–æ–ª—å—à–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–µ—Ä–≤—ã–º–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `0`)

**–ü—Ä–∏–º–µ—Ä—ã:**
```python
self.add_hook("TL_messages_readHistory")
self.add_hook("requestCall")
self.add_hook("TL_channels_readHistory")
```

–°–ø–∏—Å–æ–∫ –∏–º–µ–Ω –∑–∞–ø—Ä–æ—Å–æ–≤ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ TL-—Å—Ö–µ–º–µ[4].

### –•—É–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π[4]

–î–ª—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ —Å–ª—É—á–∞—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

```python
self.add_on_send_message_hook(priority=0)
```

### –¢–∏–ø—ã —Ö—É–∫–æ–≤

**1. API Request Hooks** ‚Äî –ø–æ–∑–≤–æ–ª—è—é—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∏–ª–∏ –∏–∑–º–µ–Ω—è—Ç—å –∏—Å—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –≤—Ö–æ–¥—è—â–∏–µ –æ—Ç–≤–µ—Ç—ã[4]:

```python
def pre_request_hook(self, request, callback, ...):
    # –î–æ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞
    pass

def post_request_hook(self, request, response, ...):
    # –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞
    pass
```

**2. Update Hooks** ‚Äî –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –æ—Ç Telegram[4]:

```python
def on_update_hook(self, update, ...):
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–¥–∏–Ω–æ—á–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
    pass

def on_updates_hook(self, updates, ...):
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
    pass
```

**3. Message Sending Hook** ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π[4]:

```python
def on_send_message_hook(self, params):
    # –ü–µ—Ä–µ—Ö–≤–∞—Ç –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
    pass
```

### HookResult –∏ HookStrategy[4]

`HookResult` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ:
- `HookStrategy.DEFAULT` ‚Äî –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –æ–±—ã—á–Ω—ã–π –ø–æ—Ç–æ–∫
- `HookStrategy.CANCEL` ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å/–ø–æ–¥–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç
- `HookStrategy.MODIFY` ‚Äî –∏–∑–º–µ–Ω–∏—Ç—å request/response/update/params
- `HookStrategy.MODIFY_FINAL` ‚Äî –∫–∞–∫ MODIFY, –Ω–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—ã–∑–æ–≤ —Ö—É–∫–æ–≤ –¥—Ä—É–≥–∏—Ö –ø–ª–∞–≥–∏–Ω–æ–≤

**–ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è:**

```python
def on_plugin_load(self):
    self.add_on_send_message_hook()

def on_send_message_hook(self, params):
    text = params.message
    if text.startswith(".wt"):
        # –ò–∑–º–µ–Ω—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
        params.message = "Weather info here"
        return HookResult(strategy=HookStrategy.MODIFY)
    return HookResult()  # –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
```

## Xposed Method Hooking

### –ë–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã —Ö—É–∫–æ–≤[5]

–°–æ–∑–¥–∞–π—Ç–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫, –Ω–∞—Å–ª–µ–¥—É—è –æ—Ç –æ–¥–Ω–æ–π –∏–∑ –±–∞–∑–æ–≤—ã—Ö –∫–ª–∞—Å—Å–æ–≤:

1. **MethodHook** ‚Äî –∑–∞–ø—É—Å–∫ –∫–æ–¥–∞ *–¥–æ* –∏/–∏–ª–∏ *–ø–æ—Å–ª–µ* –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞
2. **MethodReplacement** ‚Äî *–ø–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞* –ª–æ–≥–∏–∫–∏ –º–µ—Ç–æ–¥–∞

### –û–±—ä–µ–∫—Ç param[5]

–í—Å–µ callback –º–µ—Ç–æ–¥—ã —Ö—É–∫–æ–≤ –ø–æ–ª—É—á–∞—é—Ç –æ–±—ä–µ–∫—Ç `param` (`de.robv.android.xposed.XC_MethodHook.MethodHookParam`):

- `param.thisObject` ‚Äî —ç–∫–∑–µ–º–ø–ª—è—Ä, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –≤—ã–∑–≤–∞–Ω –º–µ—Ç–æ–¥ (`None` –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö)
- `param.args` ‚Äî —Å–ø–∏—Å–æ–∫ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –º–µ—Ç–æ–¥–∞ (–º–æ–∂–Ω–æ —á–∏—Ç–∞—Ç—å –∏ –∏–∑–º–µ–Ω—è—Ç—å)
- `param.getResult()` ‚Äî –∑–Ω–∞—á–µ–Ω–∏–µ, –≤–æ–∑–≤—Ä–∞—â–µ–Ω–Ω–æ–µ –º–µ—Ç–æ–¥–æ–º (–¥–æ—Å—Ç—É–ø–Ω–æ –≤ `after_hooked_method`)
- `param.method` ‚Äî –æ–±—ä–µ–∫—Ç `java.lang.reflect.Member` —Ö—É–∫–∞–Ω–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞
- `param.setResult(new_result)` ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ `before_hooked_method` –ø—Ä–æ–ø—É—Å—Ç–∏—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥

### –§–∏–ª—å—Ç—Ä—ã —Ö—É–∫–æ–≤[5]

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä `@hook_filters` –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è callback:

**–§–∏–ª—å—Ç—Ä—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:**
- `RESULT_IS_NULL` ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç null
- `RESULT_IS_TRUE` ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç true
- `RESULT_IS_FALSE` ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç false
- `RESULT_NOT_NULL` ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ null
- `ResultIsInstanceOf(clazz)` ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç instanceof clazz
- `ResultEqual(value)` ‚Äî result.equals(value)
- `ResultNotEqual(value)` ‚Äî !result.equals(value)

**–§–∏–ª—å—Ç—Ä—ã –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤:**
- `ArgumentIsNull(index)`
- `ArgumentNotNull(index)`
- `ArgumentIsFalse(index)`
- `ArgumentIsTrue(index)`
- `ArgumentIsInstanceOf(index, clazz)`
- `ArgumentEqual(index, value)`
- `ArgumentNotEqual(index, value)`

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:**
- `Condition(condition, object=None)` ‚Äî MVEL –≤—ã—Ä–∞–∂–µ–Ω–∏–µ
- `Or(*filters)` ‚Äî —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Ñ–∏–ª—å—Ç—Ä –∏—Å—Ç–∏–Ω–Ω—ã–π

### –ü—Ä–æ—Ü–µ—Å—Å —Ö—É–∫–∏–Ω–≥–∞ (–ø–æ—à–∞–≥–æ–≤–æ)[5]

**1. –ù–∞–π–¥–∏—Ç–µ —Ü–µ–ª–µ–≤–æ–π –º–µ—Ç–æ–¥ –∏–ª–∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä:**

```python
from java import jclass
AndroidUtilities = jclass("org.telegram.messenger.AndroidUtilities")
method = AndroidUtilities.getDeclaredMethod("dp", float)
```

**2. –†–µ–∞–ª–∏–∑—É–π—Ç–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ö—É–∫–∞:**

```python
class MyMethodHook(MethodHook):
    def before_hooked_method(self, param):
        # –ö–æ–¥ –¥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–µ—Ç–æ–¥–∞
        pass
    
    def after_hooked_method(self, param):
        # –ö–æ–¥ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–µ—Ç–æ–¥–∞
        pass
```

**3. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ —Ö—É–∫:**

```python
def on_plugin_load(self):
    hook_handler = MyMethodHook()
    self.hook_method(method, hook_handler)
```

**4. –•—É–∫ –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤ —Å –∏–º–µ–Ω–µ–º:**

```python
self.hook_all_methods(hook_class, method_name, xposed_hook, priority)
self.hook_all_constructors(hook_class, xposed_hook, priority)
```

**5. Unhooking (–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ —Ö—É–∫–∞):**

```python
unhook = self.hook_method(...)
self.unhook_method(unhook)
```

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã[5]

**–ü—Ä–∏–º–µ—Ä 1: –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ (Before Hook)**

```python
class ToastHook(MethodHook):
    def before_hooked_method(self, param):
        # –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ—Ñ–∏–∫—Å –∫ —Ç–µ–∫—Å—Ç—É Toast
        param.args[0] = "[Plugin] " + str(param.args[0])
```

**–ü—Ä–∏–º–µ—Ä 2: –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è (After Hook)**

```python
class MainAppHook(MethodHook):
    def after_hooked_method(self, param):
        param.setResult(False)  # –í—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å False
```

**–ü—Ä–∏–º–µ—Ä 3: –ó–∞–º–µ–Ω–∞ –º–µ—Ç–æ–¥–∞ (MethodReplacement)**

```python
class LogDisableReplacement(MethodReplacement):
    def replace_hooked_method(self, param):
        return None  # –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–ª–∞–≥–∏–Ω–∞ (Plugin Settings)

### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫[4]

–†–µ–∞–ª–∏–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ `create_settings`, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç—Ä–æ–ª–æ–≤ UI:

```python
from ui.settings import Header, Switch, Selector, Input, Text, EditText, Divider

def create_settings(self):
    return [
        Header(text="My Plugin Settings"),
        Switch(key="enable_feature", text="Enable Feature", default=True),
        Selector(
            key="mode", 
            text="Select Mode",
            items=["Mode 1", "Mode 2", "Mode 3"],
            default=0
        ),
        Input(key="api_key", text="API Key", default=""),
        Divider(text="Advanced"),
        EditText(key="notes", hint="Enter notes", multiline=True)
    ]
```

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–Ω—Ç—Ä–æ–ª—ã[4]

| –ö–æ–Ω—Ç—Ä–æ–ª | key | text | default | –î—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã |
|---------|-----|------|---------|------------------|
| Header | - | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | - | `text`: –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å–µ–∫—Ü–∏–∏ |
| Divider | - | - | - | `text`: –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∑–∞–º–µ—Ç–∫–∞ |
| Switch | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | `bool` | `subtext`, `icon`, `on_change(bool)`, `on_long_click(View)`, `link_alias` |
| Selector | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | `int` –∏–Ω–¥–µ–∫—Å | `items: List[str]`, `icon`, `on_change(int)`, `link_alias` |
| Input | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | `str` | `subtext`, `icon`, `on_change(str)`, `link_alias` |
| Text | - | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | - | `icon`, `accent: bool`, `red: bool`, `on_click(View)`, `create_sub_fragment()`, `link_alias` |
| EditText | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | - | `str` | `hint`, `multiline: bool`, `max_length: int`, `mask: str` (regex), `on_change(str)` |

### –î–æ—Å—Ç—É–ø –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º[4]

**–ß—Ç–µ–Ω–∏–µ:**
```python
value = self.get_setting("key", default_value)
```

**–ó–∞–ø–∏—Å—å:**
```python
self.set_setting("key", value, reload_settings=False)
```

**–≠–∫—Å–ø–æ—Ä—Ç/–ò–º–ø–æ—Ä—Ç –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫:**
```python
settings_dict = self.export_settings()
self.import_settings(settings_dict)
```

## Android Utilities

### Proxy –∫–ª–∞—Å—Å—ã –¥–ª—è Java –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤[6]

**R (Runnable Proxy)** ‚Äî `static_proxy` –¥–ª—è `java.lang.Runnable`[6]:
```python
from android_utils import R, run_on_ui_thread

runnable = R(lambda: self.log("Running on UI thread"))
run_on_ui_thread(runnable)
```

**OnClickListener** ‚Äî `dynamic_proxy` –¥–ª—è `android.view.View.OnClickListener`[6]:
```python
from android_utils import OnClickListener

button.setOnClickListener(OnClickListener(lambda view: self.log("Clicked!")))
```

**OnLongClickListener** ‚Äî `dynamic_proxy` –¥–ª—è `android.view.View.OnLongClickListener`[6]:
```python
from android_utils import OnLongClickListener

def on_long_click(view):
    self.log("Long pressed!")
    return True  # –°–æ–±—ã—Ç–∏–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ

button.setOnLongClickListener(OnLongClickListener(on_long_click))
```

### –£—Ç–∏–ª–∏—Ç—ã[6]

**run_on_ui_thread** ‚Äî –≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–∞ UI –ø–æ—Ç–æ–∫–µ[6]:
```python
from android_utils import run_on_ui_thread

run_on_ui_thread(lambda: update_ui(), delay=0)  # delay –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
```

**log** ‚Äî –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ logcat[6]:
```python
from android_utils import log

log("Simple message")
log(complex_object)  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç—Å—è –≤ JSON
```

## Client Utilities

### –§–æ–Ω–æ–≤—ã–µ –ø–æ—Ç–æ–∫–∏ (Queues)[7]

–î–ª—è –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ UI:

```python
from client_utils import run_on_queue

run_on_queue(my_function, queue_name="file", delay=0)
```

**–î–æ—Å—Ç—É–ø–Ω—ã–µ –æ—á–µ—Ä–µ–¥–∏ (—Å—Ç—Ä–æ–∫–æ–≤—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã):**
- `"file"` ‚Äî –¥–ª—è —Ñ–∞–π–ª–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- `"search"` ‚Äî –¥–ª—è –ø–æ–∏—Å–∫–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –∏ –¥—Ä—É–≥–∏–µ –¥–∏—Å–ø–µ—Ç—á–µ—Ä—Å–∫–∏–µ –æ—á–µ—Ä–µ–¥–∏ Telegram

**–ü–æ–ª—É—á–∏—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä –æ—á–µ—Ä–µ–¥–∏:**
```python
from client_utils import get_dispatch_queue

queue = get_dispatch_queue("file")
```

### –û—Ç–ø—Ä–∞–≤–∫–∞ API –∑–∞–ø—Ä–æ—Å–æ–≤[7]

```python
from client_utils import send_request, RequestCallback

def on_response(response, error):
    if error:
        self.log(f"Error: {error}")
    else:
        self.log(f"Response: {response}")

request = TLRPC.TL_messages_getHistory()
request.peer = peer
request.limit = 10

send_request(request, RequestCallback(on_response))
```

### –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –º–µ–¥–∏–∞[7]

**–¢–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:**
```python
from client_utils import send_text

send_text(
    dialog_id=chat_id,
    text="Hello, World!",
    entities=None,  # TLRPC.MessageEntity —Å–ø–∏—Å–æ–∫
    replyToMsg=None,
    scheduleDate=None
)
```

**–§–æ—Ç–æ:**
```python
from client_utils import send_photo

send_photo(
    dialog_id=chat_id,
    file_path="/path/to/photo.jpg",
    caption="My photo",
    caption_entities=None
)
```

**–í–∏–¥–µ–æ:**
```python
from client_utils import send_video

send_video(
    dialog_id=chat_id,
    file_path="/path/to/video.mp4",
    caption="My video"
)
```

**–î–æ–∫—É–º–µ–Ω—Ç:**
```python
from client_utils import send_document

send_document(
    dialog_id=chat_id,
    file_path="/path/to/file.pdf",
    caption="Document"
)
```

**–ê—É–¥–∏–æ:**
```python
from client_utils import send_audio

send_audio(
    dialog_id=chat_id,
    file_path="/path/to/song.mp3",
    caption="Music"
)
```

### –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π[7]

```python
from client_utils import edit_message

edit_message(
    dialog_id=chat_id,
    message_id=msg_id,
    new_text="Edited text",
    entities=None,
    with_spoiler=False
)
```

### –î–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞–º –∏ –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º[7]

```python
from client_utils import (
    get_messages_controller,
    get_messages_storage,
    get_send_messages_helper,
    get_account_instance,
    get_user_config,
    get_connection_manager
)

messages_controller = get_messages_controller()
messages_storage = get_messages_storage()
```

## Bulletin Helper (–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞)

### –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ bulletins[8]

```python
from bulletin import BulletinHelper

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
BulletinHelper.show_info("Information message", fragment=None)

# –û—à–∏–±–∫–∞
BulletinHelper.show_error("Error occurred!", fragment=None)

# –£—Å–ø–µ—Ö
BulletinHelper.show_success("Operation successful!", fragment=None)
```

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ bulletins[8]

```python
from bulletin import BulletinHelper
from org.telegram.messenger import R as R_tg

# –û–¥–Ω–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Å –∫–∞—Å—Ç–æ–º–Ω–æ–π –∏–∫–æ–Ω–∫–æ–π
BulletinHelper.show_simple(
    text="Custom message",
    icon_res_id=R_tg.raw.info,
    fragment=None
)

# –î–≤—É—Ö—Å—Ç—Ä–æ—á–Ω—ã–π
BulletinHelper.show_two_line(
    title="Title",
    subtitle="Subtitle text",
    icon_res_id=R_tg.raw.success,
    fragment=None
)
```

### Bulletins —Å –¥–µ–π—Å—Ç–≤–∏—è–º–∏[8]

**–° –∫–Ω–æ–ø–∫–æ–π:**
```python
def on_button_click():
    self.log("Button clicked!")

BulletinHelper.show_with_button(
    text="Message with button",
    icon_res_id=R_tg.raw.info,
    button_text="OK",
    on_click=on_button_click,
    fragment=None,
    duration=BulletinHelper.DURATION_PROLONG
)
```

**Undo-—Å—Ç–∏–ª—å:**
```python
def on_undo():
    self.log("Undone!")

def on_action():
    self.log("Action confirmed!")

BulletinHelper.show_undo(
    text="Item deleted",
    on_undo=on_undo,
    on_action=on_action,
    subtitle=None,
    fragment=None
)
```

### –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ bulletins[8]

```python
# –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä
BulletinHelper.show_copied_to_clipboard(message="Copied!", fragment=None)

# –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞
BulletinHelper.show_link_copied(is_private_link_info=False, fragment=None)

# –§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –≥–∞–ª–µ—Ä–µ—é
BulletinHelper.show_file_saved_to_gallery(is_video=False, amount=1, fragment=None)

# –§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –∑–∞–≥—Ä—É–∑–∫–∏
BulletinHelper.show_file_saved_to_downloads(
    file_type_enum_name="UNKNOWN",
    amount=1,
    fragment=None
)
```

### –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏[8]

```python
BulletinHelper.DURATION_SHORT   # 1500 –º—Å
BulletinHelper.DURATION_LONG    # 2750 –º—Å
BulletinHelper.DURATION_PROLONG # 5000 –º—Å
```

## Alert Dialog Builder

### –¢–∏–ø—ã –¥–∏–∞–ª–æ–≥–æ–≤[9]

```python
from alert import AlertDialogBuilder

# –û–±—ã—á–Ω—ã–π –¥–∏–∞–ª–æ–≥
AlertDialogBuilder.ALERT_TYPE_MESSAGE

# –° –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–º (–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)
AlertDialogBuilder.ALERT_TYPE_LOADING

# –°–æ —Å–ø–∏–Ω–Ω–µ—Ä–æ–º (–∏–Ω–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)
AlertDialogBuilder.ALERT_TYPE_SPINNER
```

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ[9]

```python
from alert import AlertDialogBuilder

context = self.get_last_fragment().getParentActivity()

builder = AlertDialogBuilder(context)
builder.set_title("Dialog Title")
builder.set_message("This is a message")
builder.set_positive_button("OK", lambda bld, btn: bld.dismiss())
builder.set_negative_button("Cancel", lambda bld, btn: bld.dismiss())
builder.show()
```

### –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã[9]

**–ö–æ–Ω—Ç–µ–Ω—Ç:**
- `set_title(title: str)` ‚Äî –∑–∞–≥–æ–ª–æ–≤–æ–∫
- `set_message(message: str)` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- `set_view(view: View, height: int)` ‚Äî –∫–∞—Å—Ç–æ–º–Ω—ã–π View
- `set_items(items: List[str], listener, icons)` ‚Äî —Å–ø–∏—Å–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤

**–ö–Ω–æ–ø–∫–∏:**
- `set_positive_button(text: str, listener)` ‚Äî –ø–æ–∑–∏—Ç–∏–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞
- `set_negative_button(text: str, listener)` ‚Äî –Ω–µ–≥–∞—Ç–∏–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞
- `set_neutral_button(text: str, listener)` ‚Äî –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–∞—è –∫–Ω–æ–ø–∫–∞
- `make_button_red(button_type: int)` ‚Äî —Å–¥–µ–ª–∞—Ç—å –∫–Ω–æ–ø–∫—É –∫—Ä–∞—Å–Ω–æ–π

**–°–ª—É—à–∞—Ç–µ–ª–∏:**
- `set_on_back_button_listener(listener)` ‚Äî –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞–∑–∞–¥
- `set_on_dismiss_listener(listener)` ‚Äî –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –¥–∏–∞–ª–æ–≥–∞
- `set_on_cancel_listener(listener)` ‚Äî –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ

**–í–Ω–µ—à–Ω–∏–π –≤–∏–¥:**
- `set_top_image(res_id, background_color)` ‚Äî –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–≤–µ—Ä—Ö—É
- `set_top_animation(res_id, size, auto_repeat, background_color)` ‚Äî –∞–Ω–∏–º–∞—Ü–∏—è
- `set_dim_enabled(enabled: bool)` ‚Äî –∑–∞—Ç–µ–º–Ω–µ–Ω–∏–µ —Ñ–æ–Ω–∞
- `set_blurred_background(blur: bool)` ‚Äî —Ä–∞–∑–º—ã—Ç—ã–π —Ñ–æ–Ω
- `set_cancelable(cancelable: bool)` ‚Äî –º–æ–∂–Ω–æ –ª–∏ –∑–∞–∫—Ä—ã—Ç—å
- `set_canceled_on_touch_outside(cancel: bool)` ‚Äî –∑–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –∫–∞—Å–∞–Ω–∏–∏ –≤–Ω–µ –¥–∏–∞–ª–æ–≥–∞

**–ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª:**
- `create()` ‚Äî —Å–æ–∑–¥–∞—Ç—å –¥–∏–∞–ª–æ–≥ (–Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—è)
- `show()` ‚Äî —Å–æ–∑–¥–∞—Ç—å –∏ –ø–æ–∫–∞–∑–∞—Ç—å
- `dismiss()` ‚Äî –∑–∞–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥
- `get_dialog()` ‚Äî –ø–æ–ª—É—á–∏—Ç—å Java `AlertDialog`
- `get_button(button_type)` ‚Äî –ø–æ–ª—É—á–∏—Ç—å View –∫–Ω–æ–ø–∫–∏

**–ü—Ä–æ–≥—Ä–µ—Å—Å:**
- `set_progress(progress: int)` ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å (0-100) –¥–ª—è `ALERT_TYPE_LOADING`

### –î–∏–∞–ª–æ–≥ —Å–æ —Å–ø–∏—Å–∫–æ–º[9]

```python
def on_item_click(builder, index):
    builder.dismiss()
    self.log(f"Selected item {index}")

builder = AlertDialogBuilder(context)
builder.set_title("Choose Option")
builder.set_items(
    items=["Option 1", "Option 2", "Option 3"],
    listener=on_item_click,
    icons=None
)
builder.show()
```

## Markdown Parser

### –ü–∞—Ä—Å–∏–Ω–≥ markdown[10]

```python
from markdown_utils import parse_markdown

parsed = parse_markdown("*bold* _italic_ `code`")
text = parsed.text  # –û–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç –±–µ–∑ –º–∞—Ä–∫–µ—Ä–æ–≤
entities = parsed.entities  # Tuple[RawEntity, ...]
```

### ParsedMessage[10]

–û–±—ä–µ–∫—Ç —Å –¥–≤—É–º—è –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏:
- `text: str` ‚Äî —Ç–µ–∫—Å—Ç –±–µ–∑ markdown –º–∞—Ä–∫–µ—Ä–æ–≤
- `entities: Tuple[RawEntity, ...]` ‚Äî —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### RawEntity[10]

–ö–∞–∂–¥–∞—è —Å—É—â–Ω–æ—Å—Ç—å —Å–æ–¥–µ—Ä–∂–∏—Ç:
- `type: TLEntityType` ‚Äî —Ç–∏–ø (bold, italic, code –∏ —Ç.–¥.)
- `offset: int` ‚Äî –Ω–∞—á–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è (UTF-16 code units)
- `length: int` ‚Äî –¥–ª–∏–Ω–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞
- `language: Optional[str]` ‚Äî –¥–ª—è `pre` (code block)
- `url: Optional[str]` ‚Äî –¥–ª—è `text_link`
- `document_id: Optional[int]` ‚Äî –¥–ª—è `custom_emoji`

### –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ TLRPC[10]

```python
tlrpc_entities = [entity.to_tlrpc_object() for entity in parsed.entities]

send_text(
    dialog_id=chat_id,
    text=parsed.text,
    entities=tlrpc_entities
)
```

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è[10]

- `BOLD` ‚Äî `*bold*`
- `ITALIC` ‚Äî `_italic_`
- `UNDERLINE` ‚Äî `__underline__`
- `STRIKETHROUGH` ‚Äî `~strikethrough~`
- `SPOILER` ‚Äî `||spoiler||`
- `CODE` ‚Äî inline \`code\`
- `PRE` ‚Äî \`\`\`code block\`\`\` (—Å –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º —è–∑—ã–∫–æ–º)
- `TEXT_LINK` ‚Äî `[link text](http://example.com)`
- `CUSTOM_EMOJI` ‚Äî `[alt text](document_id)`

## –î–æ—Å—Ç—É–ø–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

### Python –≤–µ—Ä—Å–∏—è[11]

**Python 3.11**

### –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏[11]

- `beautifulsoup4` ‚Äî –ø–∞—Ä—Å–∏–Ω–≥ HTML –∏ XML
- `debugpy` ‚Äî –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –æ—Ç–ª–∞–¥—á–∏–∫ Python –æ—Ç Microsoft
- `lxml` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ XML –∏ HTML
- `packaging` ‚Äî —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è –ø–∞–∫–µ—Ç–æ–≤
- `pillow` ‚Äî PIL fork –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- `requests` ‚Äî HTTP –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
- `PyYAML` ‚Äî –ø–∞—Ä—Å–µ—Ä YAML

**–í–∞–∂–Ω–æ:** –ï—Å–ª–∏ –≤–∞—à–µ–º—É –ø–ª–∞–≥–∏–Ω—É –Ω—É–∂–Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞, –∫–æ—Ç–æ—Ä–æ–π –Ω–µ—Ç –≤ —Å–ø–∏—Å–∫–µ, –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –∏–ª–∏ –Ω–∞–π—Ç–∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—É –≤ Java[11].

## –û–±—â–∏–µ –∫–ª–∞—Å—Å—ã Telegram

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–ª–∞—Å—Å—ã –∏ –ø—É—Ç–∏[12]

**LaunchActivity** ‚Äî `TMessagesProj/src/main/java/org/telegram/ui/LaunchActivity.java`
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —Å—Å—ã–ª–æ–∫

**ProfileActivity** ‚Äî `TMessagesProj/src/main/java/org/telegram/ui/ProfileActivity.java`
- –§—Ä–∞–≥–º–µ–Ω—Ç –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è/–∫–∞–Ω–∞–ª–∞

**ChatActivity** ‚Äî `TMessagesProj/src/main/java/org/telegram/ui/ChatActivity.java`
- –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —á–∞—Ç–∞

**MessageObject** ‚Äî `TMessagesProj/src/main/java/org/telegram/messenger/MessageObject.java`
- –û–±–µ—Ä—Ç–∫–∞ –¥–ª—è `TLRPC.Message`

**ChatMessageCell** ‚Äî `TMessagesProj/src/main/java/org/telegram/ui/Cells/ChatMessageCell.java`
- –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å–æ–æ–±—â–µ–Ω–∏–π

**AndroidUtilities** ‚Äî `TMessagesProj/src/main/java/org/telegram/messenger/AndroidUtilities.java`
- –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–æ–ª–µ–∑–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç

**MessagesController** ‚Äî `TMessagesProj/src/main/java/org/telegram/messenger/MessagesController.java`
- –ú–µ—Ç–æ–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ Telegram –∑–∞–ø—Ä–æ—Å–æ–≤

**MessagesStorage** ‚Äî `TMessagesProj/src/main/java/org/telegram/messenger/MessagesStorage.java`
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î. –ü–æ–ª–µ `database` –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è SQL –∑–∞–ø—Ä–æ—Å–æ–≤

**SendMessagesHelper** ‚Äî `TMessagesProj/src/main/java/org/telegram/messenger/SendMessagesHelper.java`
- –ú–µ—Ç–æ–¥—ã –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π, –≤–∫–ª—é—á–∞—è —Ñ–∞–π–ª—ã

**BulletinFactory** ‚Äî `TMessagesProj/src/main/java/org/telegram/ui/Components/BulletinFactory.java`
- Bulletins (—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞)

**AlertDialog** ‚Äî `TMessagesProj/src/main/java/org/telegram/ui/ActionBar/AlertDialog.java`
- –î–∏–∞–ª–æ–≥–∏ –ø–æ–≤–µ—Ä—Ö —Ç–µ–∫—É—â–µ–≥–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞

**TLRPC** ‚Äî `TMessagesProj/src/main/java/org/telegram/tgnet`
- –í—Å–µ –º–æ–¥–µ–ª–∏ Telegram –∑–∞–ø—Ä–æ—Å–æ–≤. –ß–∏—Ç–∞–µ–º—ã–π —Å–ø–∏—Å–æ–∫: https://corefork.telegram.org/schema

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: Weather –ø–ª–∞–≥–∏–Ω

### –ü–æ–ª–Ω—ã–π –∫–æ–¥ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏[3]

```python
__id__ = "weather"
__name__ = "Weather"
__description__ = "Get weather info with .wt command"
__author__ = "@yourUsername"
__version__ = "1.0.0"
__icon__ = "exteraPlugins/1"
__min_version__ = "11.12.0"

from base_plugin import BasePlugin, HookResult, HookStrategy
import requests
from alert import AlertDialogBuilder
from android_utils import run_on_ui_thread
from client_utils import run_on_queue, send_text

class WeatherPlugin(BasePlugin):
    def __init__(self):
        super().__init__()
        self.progress_dialog_builder = None
    
    def on_plugin_load(self):
        self.add_on_send_message_hook()
    
    def on_send_message_hook(self, params):
        text = params.message
        if not text.startswith(".wt"):
            return HookResult()
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–∏–∞–ª–æ–≥
        context = self.get_last_fragment().getParentActivity()
        self.progress_dialog_builder = AlertDialogBuilder(
            context,
            AlertDialogBuilder.ALERT_TYPE_SPINNER
        )
        self.progress_dialog_builder.set_message("Fetching weather...")
        self.progress_dialog_builder.set_cancelable(False)
        self.progress_dialog_builder.show()
        
        # –ó–∞–ø—É—Å–∫–∞–µ–º –≤ —Ñ–æ–Ω–µ
        location = text[3:].strip() or "London"
        run_on_queue(
            lambda: self._process_weather_request(params.dialog_id, location)
        )
        
        # –û—Ç–º–µ–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É
        return HookResult(strategy=HookStrategy.CANCEL)
    
    def _process_weather_request(self, dialog_id, location):
        try:
            weather_data = self._fetch_weather(location)
            formatted = self._format_weather(weather_data)
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ UI –ø–æ—Ç–æ–∫–µ
            run_on_ui_thread(
                lambda: self._send_message_and_dismiss_dialog(dialog_id, formatted)
            )
        except Exception as e:
            error_msg = f"Error: {str(e)}"
            run_on_ui_thread(
                lambda: self._send_message_and_dismiss_dialog(dialog_id, error_msg)
            )
    
    def _send_message_and_dismiss_dialog(self, dialog_id, message):
        if self.progress_dialog_builder:
            self.progress_dialog_builder.dismiss()
        send_text(dialog_id=dialog_id, text=message)
    
    def _fetch_weather(self, location):
        url = f"https://wttr.in/{location}?format=j1"
        response = requests.get(url, timeout=5)
        response.raise_for_status()
        return response.json()
    
    def _format_weather(self, data):
        current = data['current_condition'][0]
        return f"üå§ Weather: {current['weatherDesc'][0]['value']}\n" \
               f"üå° Temp: {current['temp_C']}¬∞C\n" \
               f"üí® Wind: {current['windspeedKmph']} km/h"
```

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏ best practices

1. **–ü–æ—Ç–æ–∫–∏:** –í—Å–µ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–π—Ç–µ –±–ª–æ–∫–∏—Ä—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (—Å–µ—Ç—å, —Ñ–∞–π–ª—ã) –≤ —Ñ–æ–Ω–æ–≤—ã—Ö –ø–æ—Ç–æ–∫–∞—Ö —á–µ—Ä–µ–∑ `run_on_queue`[3][7]
2. **UI –æ–ø–µ—Ä–∞—Ü–∏–∏:** –õ—é–±—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è UI –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –Ω–∞ UI –ø–æ—Ç–æ–∫–µ —á–µ—Ä–µ–∑ `run_on_ui_thread`[6]
3. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `self.log()` –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏. –õ–æ–≥–∏ –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ `adb logcat`[6]
4. **–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ:** –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—é –∏–ª–∏ f-—Å—Ç—Ä–æ–∫–∏ –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö ‚Äî —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏[4]
5. **–ö–æ–Ω—Ç–µ–∫—Å—Ç –º–µ–Ω—é:** –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–µ–π –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º[4]
6. **–†–µ—Å—É—Ä—Å—ã:** Bulletins –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –Ω–∞ UI –ø–æ—Ç–æ–∫–µ, –æ–±–µ—Ä—Ç–∫–∞ –Ω–µ –Ω—É–∂–Ω–∞[8]
7. **–î–∏–∞–ª–æ–≥–∏:** –í—ã–∑—ã–≤–∞–π—Ç–µ –º–µ—Ç–æ–¥—ã –¥–∏–∞–ª–æ–≥–æ–≤ –Ω–∞ UI –ø–æ—Ç–æ–∫–µ[9]
8. **–•—É–∫–∏:** –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `MODIFY`, –Ω–µ –∑–∞–±—É–¥—å—Ç–µ –≤–µ—Ä–Ω—É—Ç—å –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç –≤ `HookResult`[4]

## –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

- –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: https://plugins.exteragram.app/docs[1][3][2][4][11]
- –ö–∞–Ω–∞–ª —Å –ø–ª–∞–≥–∏–Ω–∞–º–∏: @exteraPlugins[3]
- GitHub: https://github.com/exteraSquad/exteraGram[13][14]
- FAQ: @exteraFAQ[15][16]

–≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞–≥–∏–Ω–æ–≤ –¥–ª—è exteraGram, –æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–æ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö —Ç–µ—Ö–Ω–∏–∫ —Ö—É–∫–æ–≤ –∏ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.

–¶–∏—Ç–∞—Ç—ã:
[1] Setup https://plugins.exteragram.app/docs/setup
[2] Introduction - exteraGram Plugins https://plugins.exteragram.app/docs
[3] First Plugin | exteraGram https://plugins.exteragram.app/docs/first-plugin
[4] Plugin Class https://plugins.exteragram.app/docs/plugin-class
[5] Xposed Method Hooking https://plugins.exteragram.app/docs/xposed-hooking
[6] Android Utilities https://plugins.exteragram.app/docs/android-utils
[7] Client Utilities - exteraGram Plugins https://plugins.exteragram.app/docs/client-utils
[8] Bulletin Helper https://plugins.exteragram.app/docs/bulletin-helper
[9] Alert Dialog Builder https://plugins.exteragram.app/docs/alert-dialog-builder
[10] Markdown Parser https://plugins.exteragram.app/docs/markdown-utils
[11] Available Libraries https://plugins.exteragram.app/docs/available-libraries
[12] Common Telegram Classes https://plugins.exteragram.app/docs/common-source-classes
[13] exteraSquad/exteraGram: Telegram client based on ... - GitHub https://github.com/exteraSquad/exteraGram
[14] exteraGram/README.md at main ¬∑ exteraSquad/exteraGram https://github.com/exteraSquad/exteraGram/blob/main/README.md
[15] exteraGram Beta https://t.me/s/exteraGramCI
[16] exteraGram https://t.me/s/exteraGram
[17] –°–æ–∑–¥–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ –ø–µ—Ä–≤–æ–≥–æ –ø–ª–∞–≥–∏–Ω–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è - Unigine Developer https://developer.unigine.com/ru/docs/latest/editor2/extensions/custom_plugin
[18] How to Set Up exteraGram: Your Guide to an Experimental Telegram Client fxis.ai https://fxis.ai/edu/how-to-set-up-exteragram-your-guide-to-an-experimental-telegram-client/
[19] exteragram-utils https://www.piwheels.org/project/exteragram-utils/
[20] Post #9508 ‚Äî ATT ‚Ä¢ Tech News (@agamtechtricks) https://in.tgstat.com/channel/@agamtechtricks/9508
[21] exteraGram - fork of Telegram for Android https://apkport.com/exteragram-fork-of-telegram-for-android/
[22] Releases ¬∑ exteraSquad/exteraGram https://github.com/exteraSquad/exteraGram/releases
[23] Build your first plugin: 3. Plugin Environment Setup https://www.youtube.com/watch?v=p-z566ILvxc
[24] exteraGram https://t.me/s/exteraGram?before=185
[25] –°–∫–∞—á–∞—Ç—å exteraGram 12.1.1 –¥–ª—è Android https://trashbox.ru/link/exteragram-android
[26] [PDF] Developer Manual - Frama-C https://frama-c.com/download/plugin-development-guide-26.1-Iron.pdf
[27] Grafana Plugins - extend and customize your ... https://grafana.com/grafana/plugins/
[28] Documentation about modifying exteraGram using Python. https://plugins.exteragram.app
[29] UMR-CNRM/EPyGrAM: Enhanced Python for Graphics and ... - GitHub https://github.com/UMR-CNRM/EPyGrAM
[30] –Ø —Ö–æ—á—É –Ω–∞—á–∞—Ç—å –¥–µ–ª–∞—Ç—å –ø–ª–∞–≥–∏–Ω—ã –¥–ª—è exteragram –æ–Ω–∏ –¥... https://chat01.ai/ru/chat/01JZ15Y5DR873393VN1536CSAS
[31] exteragram-utils ¬∑ PyPI https://pypi.org/project/exteragram-utils/
[32] 12 Python Data Visualization Libraries to Explore for ... https://mode.com/blog/python-data-visualization-libraries/
[33] ExteraGram: An In-Depth Overview - Premium Telegram Name https://tgnames.com/mods/exteragram-an-in-depth-overview/
[34] exteraSquad/exteraGram https://github.com/exteraSquad/exteraGram/issues
[35] Day 7 - Working with External Libraries (Python Lesson 7) https://www.youtube.com/watch?v=NCAmCiYqPUo
[36] Plugin API Reference Documentation https://www.amplenote.com/help/developing_amplenote_plugins
[37] exteraGram Beta https://t.me/s/exteraGramCI?before=283
[38] Which Python library is recommended for creating ... https://discuss.python.org/t/which-python-library-is-recommended-for-creating-customized-charts/39492
[39] Intro to making plugins in Figma https://www.youtube.com/watch?v=pA4n712h1Vc
[40] The best unofficial Telegram app for Android https://www.reddit.com/r/androidapps/comments/1hrt449/the_best_unofficial_telegram_app_for_android/
[41] AyuGram ¬∑ GitHub https://github.com/AyuGram
[42] Xposed Module Development Starter Nanny Level Tutorial https://blog.ketal.icu/en/Xposed%E6%A8%A1%E5%9D%97%E5%BC%80%E5%8F%91%E5%85%A5%E9%97%A8%E4%BF%9D%E5%A7%86%E7%BA%A7%E6%95%99%E7%A8%8B/
[43] Android Xposed Hook Example - Arophix https://arophix.com/2018/10/16/android-xposed-hook-example/
[44] exteraGram https://t.me/s/exteragram?before=150
[45] Hook A Private Method In Another App Using Xposed https://stackoverflow.com/questions/37259755/hook-a-private-method-in-another-app-using-xposed
[46] exteraSquad/exteraGram https://github.com/exteraSquad/exteraGram/labels
[47] Development tutorial https://github.com/rovo89/XposedBridge/wiki/Development-tutorial/0462f0f9eec958b59c593a30d83d14edd28ee43a
[48] exteraGram ‚Äì Telegram https://t.me/s/exteragram?before=179
[49] aiogram.pdf https://www.scribd.com/document/488001784/aiogram-pdf
[50] Xposed Ê°ÜÊû∂ hook ÁÆÄ‰ªã ÂéüÁêÜ Ê°à‰æã https://www.cnblogs.com/baiqiantao/p/10699552.html
[51] exteraGram ‚Äì –∫–∞—Å—Ç–æ–º–Ω—ã–π Telegram –∫–ª–∏–µ–Ω—Ç https://exteragram.app/ru
[52] Xposed hook to a system method https://stackoverflow.com/questions/73952374/xposed-hook-to-a-system-method/73960207
[53] exteraGram Telegram Channel https://telegramian.com/exteragram/
[54] Class MarkdownParser - West Wind Client Tools https://client-tools.west-wind.com/docs/_4gc1azydx.htm
[55] remarkjs/remark: markdown processor powered by plugins ... https://github.com/remarkjs/remark
[56] Memo on how to use the Markdown parser remark https://www.ekwbtblog.com/entry/2023/02/25/192520
[57] AyuGram for Android https://docs.ayugram.one/android/
[58] GitHub - syntax-tree/mdast-util-gfm-task-list-item: mdast extension to parse and serialize GFM task list items https://github.com/syntax-tree/mdast-util-gfm-task-list-item
[59] StackEdit ‚Äì In-browser Markdown editor https://stackedit.io
[60] AST„ÇíÁµåÁî±„Åó„Å¶Markdown„ÅÆparse„ÄÅcompile„ÇíË°å„ÅÜ - notebook https://swfz.hatenablog.com/entry/2022/02/26/181414
[61] Markdown https://docs.aiogram.dev/en/v2.25.1/utils/markdown.html
[62] exteraSquad https://github.com/exteraSquad
[63] Online Markdown Editor - Dillinger, the Last Markdown Editor ever. https://dillinger.io
[64] exteraStore - A revolutionary plugin store for Telegram https://www.exterastore.app
[65] Android - Alert Dialog https://www.tutorialspoint.com/android/android_alert_dialoges.htm
[66] How to create AlertDialog in Android | 2024 https://www.youtube.com/watch?v=sNyZCyisxX0
[67] Creating an Alert Dialog (popup box) | #1 https://www.youtube.com/watch?v=n8oasrJs_eY
[68] GitHub - dustinkredmond/FXAlert: JavaFX Alerts made easy. Easily create alerts, notifications, input dialogs, and more... https://github.com/dustinkredmond/FXAlert
[69] Telegram-–∫–∞–Ω–∞–ª exteraGram Plugins https://sticker-collection.com/channels/exteraPluginsSup?culture=ru
[70] flutter alert, alertDialog, dialog Íµ¨ÌòÑÌïòÍ∏∞ - ÏèòÎãàÏùò Í∞úÎ∞úÎ∏îÎ°úÍ∑∏ https://juntcom.tistory.com/269
[71] Telegram channel exteraGram Plugins https://sticker-collection.com/channels/exteraPluginsSup?culture=en
[72] Dialog Builder Documentation https://www.magnetismsolutions.com/documentation/dialog-builder
[73] Flutter Alert Dialog, Progress, Auto Close - Îã¨ÎßùÏù¥ ÏÇΩÏßàÏù∏ÏÉù https://dalgonakit.tistory.com/109
[74] exteraGram https://t.me/exteraGram
[75] Top Flutter Dialogs packages https://fluttergems.dev/dialogs/
[76] Telegram Channel "exteraGram Plugins" https://nicegram.app/hub/channel/exteraPluginsSup
